<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jarvis — Full Frontend Voice Assistant (HTML + Tailwind + JS)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* --- Visual styles & animations --- */
    body { background: radial-gradient(ellipse at 10% 10%, #041014 0%, #000000 40%); }
    .orb {
      width: 150px; height: 150px; border-radius: 50%;
      display:flex;align-items:center;justify-content:center;font-weight:700;
      box-shadow: 0 0 40px rgba(34,211,238,0.08), inset 0 0 40px rgba(255,255,255,0.02);
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .orb.glow {
      transform: scale(1.08);
      box-shadow: 0 0 60px rgba(34,211,238,0.85), 0 0 18px rgba(34,211,238,0.35);
      animation: pulse 1s infinite alternate;
    }
    @keyframes pulse {
      from { filter: drop-shadow(0 0 10px rgba(34,211,238,0.6)); }
      to   { filter: drop-shadow(0 0 30px rgba(34,211,238,0.95)); }
    }
    .ring { position:absolute; inset: -26px; border-radius:50%; border:2px solid rgba(34,211,238,0.06); }

    /* small UI niceties */
    .glass { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); backdrop-filter: blur(6px); }
    .scrollbar-hide::-webkit-scrollbar { display: none; }
    .cmd-chip { background: rgba(255,255,255,0.03); padding:6px 10px; border-radius:999px; }
  </style>
</head>
<body class="text-cyan-200 font-sans">
  <div class="max-w-5xl mx-auto py-12 px-6">
    <header class="flex items-center justify-between mb-6">
      <h1 class="text-2xl font-bold">Jarvis — Full Frontend Voice Assistant</h1>
      <div class="text-sm opacity-70">Only HTML + Tailwind + JavaScript — runs in browser</div>
    </header>

    <main class="grid md:grid-cols-3 gap-6">
      <!-- Left: Jarvis Orb + Controls -->
      <section class="md:col-span-1 flex flex-col items-center gap-4">
        <div class="relative">
          <div id="orb" class="orb bg-gradient-to-br from-cyan-400 to-sky-600 text-black text-4xl">J</div>
          <div class="ring"></div>
        </div>

        <div class="w-full mt-2 text-center">
          <div id="status" class="text-sm opacity-80">Status: <span id="statusTxt">Idle</span></div>
          <div class="flex gap-2 mt-3 justify-center">
            <button id="btnStart" class="px-4 py-2 bg-cyan-500 rounded-md text-black font-semibold hover:bg-cyan-400">Start</button>
            <button id="btnStop" class="px-4 py-2 bg-gray-800 rounded-md border border-cyan-600 hover:bg-gray-700">Stop</button>
            <button id="btnToggleWake" class="px-4 py-2 bg-gray-800 rounded-md border border-amber-400 hover:bg-gray-700">Wake: ON</button>
          </div>

          <div class="mt-3 text-xs opacity-70">Voice: <select id="voiceSelect" class="bg-transparent border-b border-cyan-700 ml-2 outline-none"></select></div>
          <div class="mt-2 text-xs opacity-70">Language: <select id="langSelect" class="bg-transparent border-b border-cyan-700 ml-2 outline-none">
            <option value="en-US">English (en-US)</option>
            <option value="hi-IN">Hindi (hi-IN)</option>
          </select></div>

          <div class="mt-3 flex items-center gap-2 justify-center">
            <input id="volume" type="range" min="0" max="1" step="0.05" value="1" class="w-32" />
            <label class="text-xs opacity-70">Volume</label>
          </div>
        </div>

        <div class="mt-4 glass p-3 rounded-md w-full text-sm">
          <div class="font-semibold mb-1">Quick commands</div>
          <div class="flex flex-wrap gap-2">
            <span class="cmd-chip">Hello</span>
            <span class="cmd-chip">What time is it</span>
            <span class="cmd-chip">Open youtube</span>
            <span class="cmd-chip">Search for pizza</span>
            <span class="cmd-chip">Calculate 12 plus 34</span>
            <span class="cmd-chip">Set a reminder</span>
          </div>
        </div>
      </section>

      <!-- Middle: Transcript + Manual input -->
      <section class="md:col-span-1 glass p-4 rounded-md max-h-96 overflow-auto scrollbar-hide">
        <div class="flex justify-between items-center mb-3">
          <div class="font-semibold">Transcript</div>
          <div class="text-xs opacity-60">Live</div>
        </div>
        <div id="transcript" class="space-y-2 text-sm"></div>

        <div class="mt-4">
          <label class="text-xs opacity-70">Type command (manual)</label>
          <div class="flex gap-2 mt-2">
            <input id="manualInput" class="flex-1 bg-transparent border-b border-cyan-700 px-2 py-1 outline-none" placeholder="e.g. what is the time" />
            <button id="sendManual" class="px-3 py-1 bg-cyan-500 text-black rounded-md">Send</button>
          </div>
        </div>

        <div class="mt-3 text-xs opacity-70">Tip: Say "Jarvis" then your command (wake-word), or disable wake-word in settings.</div>
      </section>

      <!-- Right: Logs / Settings / Help -->
      <section class="md:col-span-1 glass p-4 rounded-md">
        <div class="font-semibold mb-2">History & Actions</div>
        <div id="history" class="text-sm max-h-48 overflow-auto scrollbar-hide"></div>

        <div class="mt-4 font-semibold">Help</div>
        <ul class="mt-2 text-sm list-disc list-inside opacity-80">
          <li>Say "Jarvis" before commands if Wake is ON.</li>
          <li>Try: "Jarvis, what's the time?" or "Open youtube"</li>
          <li>Use manual input to test commands without mic.</li>
        </ul>

        <div class="mt-4 text-xs opacity-70">Compatibility: modern Chrome / Edge. Mobile support varies.</div>
      </section>
    </main>

    <footer class="mt-8 text-xs opacity-60 text-center">Made with ❤️ — Frontend-only Jarvis. No backend. Customize commands in the script.</footer>
  </div>

  <script>
    // --- Feature detection ---
    const supportsRec = !!(window.SpeechRecognition || window.webkitSpeechRecognition);
    const supportsSynthesis = 'speechSynthesis' in window;

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = supportsRec ? new SpeechRecognition() : null;

    // Elements
    const orb = document.getElementById('orb');
    const statusTxt = document.getElementById('statusTxt');
    const btnStart = document.getElementById('btnStart');
    const btnStop = document.getElementById('btnStop');
    const btnToggleWake = document.getElementById('btnToggleWake');
    const transcriptEl = document.getElementById('transcript');
    const historyEl = document.getElementById('history');
    const manualInput = document.getElementById('manualInput');
    const sendManual = document.getElementById('sendManual');
    const voiceSelect = document.getElementById('voiceSelect');
    const langSelect = document.getElementById('langSelect');
    const volumeRange = document.getElementById('volume');

    // State
    let listening = false;
    let wakeWordOn = true;
    let selectedVoice = null;

    // Setup recognition
    if (supportsRec) {
      recognition.continuous = true;
      recognition.interimResults = false;
      recognition.lang = 'en-US';

      recognition.onstart = () => {
        listening = true; updateStatus('Listening');
      };
      recognition.onend = () => {
        listening = false; updateStatus('Idle');
      };
      recognition.onerror = (e) => { console.error('Recognition error', e); updateStatus('Error: ' + (e.error || 'unknown')); };

      recognition.onresult = (ev) => {
        for (let i = ev.resultIndex; i < ev.results.length; ++i) {
          const text = ev.results[i][0].transcript.trim();
          addTranscript('user', text);
          handleVoice(text.toLowerCase());
        }
      };
    } else {
      updateStatus('SpeechRecognition not supported in this browser');
    }

    // Populate voices
    function populateVoices() {
      const voices = speechSynthesis.getVoices();
      voiceSelect.innerHTML = '';
      voices.forEach((v, idx) => {
        const opt = document.createElement('option');
        opt.value = idx; opt.textContent = v.name + ' (' + v.lang + ')';
        voiceSelect.appendChild(opt);
      });
      // choose default
      if (voices.length) { selectedVoice = voices[0]; voiceSelect.value = 0; }
    }
    if (supportsSynthesis) {
      populateVoices();
      window.speechSynthesis.onvoiceschanged = populateVoices;
    } else {
      voiceSelect.innerHTML = '<option>Speech Synthesis not supported</option>';
    }

    // Controls
    btnStart.onclick = () => {
      if (!supportsRec) { alert('SpeechRecognition not supported here. Use Chrome/Edge desktop.'); return; }
      recognition.lang = langSelect.value;
      recognition.start();
      updateStatus('Starting...');
      speak('Jarvis activated');
    };
    btnStop.onclick = () => {
      if (supportsRec) recognition.stop();
      updateStatus('Stopped');
      speak('Jarvis paused');
    };
    btnToggleWake.onclick = () => {
      wakeWordOn = !wakeWordOn;
      btnToggleWake.textContent = 'Wake: ' + (wakeWordOn ? 'ON' : 'OFF');
    };

    voiceSelect.onchange = () => {
      const v = speechSynthesis.getVoices()[parseInt(voiceSelect.value)];
      if (v) selectedVoice = v;
    };
    langSelect.onchange = () => { if (supportsRec) recognition.lang = langSelect.value; };

    sendManual.onclick = () => {
      const t = manualInput.value.trim(); if (!t) return;
      addTranscript('user', t);
      handleVoice(t.toLowerCase());
      manualInput.value = '';
    };

    // Transcript / history helper
    function addTranscript(who, text) {
      const p = document.createElement('div');
      p.className = 'p-2 rounded-md ' + (who === 'user' ? 'text-right opacity-90' : 'text-left text-cyan-100');
      p.innerHTML = (who === 'user' ? '<strong>You:</strong> ' : '<strong>Jarvis:</strong> ') + escapeHtml(text);
      transcriptEl.prepend(p);
      addHistory((who === 'user' ? 'You: ' : 'Jarvis: ') + text);
    }
    function addHistory(text) {
      const d = document.createElement('div'); d.className = 'text-xs opacity-80 py-1 border-b border-cyan-900'; d.textContent = text;
      historyEl.prepend(d);
    }

    // Safe small math parser (handles + - * / and parentheses, numbers)
    function safeEvalMath(expr) {
      // allow digits, spaces, parens and operators only
      if (!/^[0-9+\-*/(). %]+$/.test(expr)) return null;
      try {
        // replace 'x' with '*'
        const sanitized = expr.replace(/x/gi, '*');
        // eslint-disable-next-line no-new-func
        const result = Function('return ' + sanitized)();
        if (typeof result === 'number' && isFinite(result)) return result;
      } catch (e) { return null; }
      return null;
    }

    // Core: Handle recognized text
    function handleVoice(text) {
      // optional: require wake word
      const wake = wakeWordOn ? text.includes('jarvis') : true;
      if (!wake) {
        // show but ignore
        addHistory('Ignored (no wake word): ' + text);
        return;
      }

      // remove wake word
      text = text.replace(/jarvis/gi, '').trim();
      if (!text) { speak('Yes sir?'); return; }

      // Commands
      // 1. time
      if (/\btime\b|\bwhat time\b|\bka time\b|\bkitne baje\b/i.test(text)) {
        const t = new Date(); const str = t.toLocaleTimeString();
        respond('The time is ' + str);
        return;
      }

      // 2. date
      if (/\bdate\b|\btoday\b|\bka din\b/i.test(text)) {
        const d = new Date(); respond('Today is ' + d.toDateString()); return;
      }

      // 3. open website / open youtube
      if (/open (youtube|google|facebook|github|stack overflow|stack overflow)/i.test(text)) {
        const site = text.match(/open (.+)$/i)[1];
        let url = 'https://' + site.replace(/ /g,'') + '.com';
        if (site.toLowerCase().includes('youtube')) url = 'https://www.youtube.com';
        if (site.toLowerCase().includes('google')) url = 'https://www.google.com';
        if (site.toLowerCase().includes('github')) url = 'https://github.com';
        respond('Opening ' + site);
        window.open(url, '_blank');
        return;
      }

      // 4. search for <term>
      if (/search for (.+)/i.test(text) || /search (.+)/i.test(text)) {
        const m = text.match(/search (?:for )?(.+)/i) || text.match(/search for (.+)/i);
        const q = m && m[1] ? m[1] : null;
        if (q) { respond('Searching for ' + q); window.open('https://www.google.com/search?q=' + encodeURIComponent(q), '_blank'); }
        return;
      }

      // 5. calculator: calculate 2 plus 2, or 'calculate 12+34'
      if (/calculate|what is|solve|kitna/gi.test(text)) {
        // extract expression
        let expr = text.replace(/calculate|what is|solve|equals|=/gi, '');
        expr = expr.replace(/plus/gi, '+').replace(/minus/gi, '-').replace(/into|times|x/gi, '*').replace(/divided by|by/gi, '/');
        const val = safeEvalMath(expr);
        if (val !== null) { respond('Result: ' + val); } else { respond('Sorry, I could not compute that.'); }
        return;
      }

      // 6. small talk
      if (/hello|hi|hey|namaste|hi jarvis/i.test(text)) { respond('Hello sir, I am Jarvis. How can I assist?'); return; }
      if (/how are you|kya haal/i.test(text)) { respond('I am operational and ready.'); return; }

      // 7. change voice or volume
      if (/volume|volume to|set volume/i.test(text)) {
        const m = text.match(/(\d+(?:\.\d+)?)/);
        if (m) { const v = Math.max(0, Math.min(1, parseFloat(m[1]) / 100)); volumeRange.value = v; respond('Volume set to ' + Math.round(v*100) + '%'); } else { respond('Please say a volume between 0 and 100'); }
        return;
      }

      // 8. fallback: echo + suggestion
      respond("I heard: '" + text + "'. I can open sites, tell time, calculate, or search the web.");
    }

    // Respond (speak + add transcript)
    function respond(msg) {
      addTranscript('jarvis', msg);
      speak(msg);
    }

    // speak wrapper
    function speak(text) {
      if (!supportsSynthesis) return;
      const utter = new SpeechSynthesisUtterance(text);
      utter.volume = parseFloat(volumeRange.value || 1);
      utter.lang = langSelect.value || 'en-US';
      if (selectedVoice) utter.voice = selectedVoice;

      // visual effect
      orb.classList.add('glow');
      setTimeout(() => {}, 10);
      utter.onend = () => { orb.classList.remove('glow'); };
      window.speechSynthesis.cancel(); // stop any speaking queue
      window.speechSynthesis.speak(utter);
    }

    // helpers
    function updateStatus(s) { statusTxt.textContent = s; }
    function escapeHtml(str){ return str.replace(/[&<>'"]/g, (c)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"})[c]); }

    // Quick keyboard shortcut: press Space to toggle listening (for convenience)
    window.addEventListener('keydown', (e)=>{
      if (e.code === 'Space') { e.preventDefault(); if (!listening) { btnStart.click(); } else { btnStop.click(); } }
    });

    // Initial status
    if (!supportsRec) updateStatus('No SpeechRecognition');
    if (!supportsSynthesis) updateStatus('SpeechSynthesis not supported');

  </script>
</body>
</html>
